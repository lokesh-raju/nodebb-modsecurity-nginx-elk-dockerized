{"version":3,"sources":["public/src/client/account/blocks.js"],"names":["define","header","Blocks","init","$","on","username","this","value","socket","emit","query","searchBy","err","data","app","alertError","message","matchCount","users","length","parseAndTranslate","edit","html","uid","parseInt","getAttribute","blockeeUid","blockerUid","ajaxify","refreshList","get","config","relative_path","currentPage","done","payload","siblings","window","trigger","fail","go"],"mappings":"AAAA,aAEAA,OAAO,wBAAyB,wBAAyB,SAAUC,GAClE,IAAIC,KAEJA,EAAOC,KAAO,WACbF,EAAOE,OAEPC,EAAE,gBAAgBC,GAAG,QAAS,WAC7B,IAAIC,EAAWC,KAAKC,MAEpBC,OAAOC,KAAK,eACXC,MAAOL,EACPM,SAAU,YACR,SAAUC,EAAKC,GACjB,GAAID,EAAK,CACR,OAAOE,IAAIC,WAAWH,EAAII,SAI3B,GAAIH,EAAKI,WAAa,GAAI,CACzBJ,EAAKK,MAAMC,OAAS,GAGrBL,IAAIM,kBAAkB,iBAAkB,QACvCC,KAAMR,EAAKK,OACT,SAAUI,GACZnB,EAAE,eAAemB,KAAKA,SAKzBnB,EAAE,eAAeC,GAAG,QAAS,yBAA0B,WACtD,IAAImB,EAAMC,SAASlB,KAAKmB,aAAa,YAAa,IAClDjB,OAAOC,KAAK,oBACXiB,WAAYH,EACZI,WAAYC,QAAQf,KAAKU,KACvBtB,EAAO4B,gBAIZ5B,EAAO4B,YAAc,SAAUjB,GAC9B,GAAIA,EAAK,CACR,OAAOE,IAAIC,WAAWH,EAAII,SAG3Bb,EAAE2B,IAAIC,OAAOC,cAAgB,QAAUJ,QAAQK,aAC7CC,KAAK,SAAUC,GACfrB,IAAIM,kBAAkB,iBAAkB,QAASe,EAAS,SAAUb,GACnEnB,EAAE,oBAAoBmB,KAAKA,GAC3BnB,EAAE,oBAAoBiC,SAAS,aAAad,EAAKH,OAAS,OAAS,YAEpEhB,EAAEkC,QAAQC,QAAQ,6BAA+BzB,KAAMsB,MAEvDI,KAAK,WACLX,QAAQY,GAAGZ,QAAQK,gBAItB,OAAOhC","file":"public/src/client/account/blocks.js","sourcesContent":["'use strict';\n\ndefine('forum/account/blocks', ['forum/account/header'], function (header) {\n\tvar Blocks = {};\n\n\tBlocks.init = function () {\n\t\theader.init();\n\n\t\t$('#user-search').on('keyup', function () {\n\t\t\tvar username = this.value;\n\n\t\t\tsocket.emit('user.search', {\n\t\t\t\tquery: username,\n\t\t\t\tsearchBy: 'username',\n\t\t\t}, function (err, data) {\n\t\t\t\tif (err) {\n\t\t\t\t\treturn app.alertError(err.message);\n\t\t\t\t}\n\n\t\t\t\t// Only show first 10 matches\n\t\t\t\tif (data.matchCount > 10) {\n\t\t\t\t\tdata.users.length = 10;\n\t\t\t\t}\n\n\t\t\t\tapp.parseAndTranslate('account/blocks', 'edit', {\n\t\t\t\t\tedit: data.users,\n\t\t\t\t}, function (html) {\n\t\t\t\t\t$('.block-edit').html(html);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\n\t\t$('.block-edit').on('click', '[data-action=\"toggle\"]', function () {\n\t\t\tvar uid = parseInt(this.getAttribute('data-uid'), 10);\n\t\t\tsocket.emit('user.toggleBlock', {\n\t\t\t\tblockeeUid: uid,\n\t\t\t\tblockerUid: ajaxify.data.uid,\n\t\t\t}, Blocks.refreshList);\n\t\t});\n\t};\n\n\tBlocks.refreshList = function (err) {\n\t\tif (err) {\n\t\t\treturn app.alertError(err.message);\n\t\t}\n\n\t\t$.get(config.relative_path + '/api/' + ajaxify.currentPage)\n\t\t\t.done(function (payload) {\n\t\t\t\tapp.parseAndTranslate('account/blocks', 'users', payload, function (html) {\n\t\t\t\t\t$('#users-container').html(html);\n\t\t\t\t\t$('#users-container').siblings('div.alert')[html.length ? 'hide' : 'show']();\n\t\t\t\t});\n\t\t\t\t$(window).trigger('action:user.blocks.toggle', { data: payload });\n\t\t\t})\n\t\t\t.fail(function () {\n\t\t\t\tajaxify.go(ajaxify.currentPage);\n\t\t\t});\n\t};\n\n\treturn Blocks;\n});\n"]}