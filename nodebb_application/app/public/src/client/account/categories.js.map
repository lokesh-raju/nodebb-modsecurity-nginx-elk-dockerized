{"version":3,"sources":["public/src/client/account/categories.js"],"names":["define","header","Categories","init","ajaxify","data","categories","forEach","category","handleIgnoreWatch","cid","$","find","on","cids","state","this","attr","each","index","el","push","socket","emit","uid","err","modified_cids","app","alertError","message","updateDropdowns","$this","alertSuccess","toggleClass"],"mappings":"AAAA,aAGAA,OAAO,4BAA6B,wBAAyB,SAAUC,GACtE,IAAIC,KAEJA,EAAWC,KAAO,WACjBF,EAAOE,OAEPC,QAAQC,KAAKC,WAAWC,QAAQ,SAAUC,GACzCC,EAAkBD,EAASE,OAG5BC,EAAE,oCAAoCC,KAAK,wGAAwGC,GAAG,QAAS,WAC9J,IAAIC,KACJ,IAAIC,EAAQJ,EAAEK,MAAMC,KAAK,cACzBN,EAAE,yBAAyBO,KAAK,SAAUC,EAAOC,GAChDN,EAAKO,KAAKV,EAAES,GAAIH,KAAK,eAGtBK,OAAOC,KAAK,4BAA8Bb,IAAKI,EAAMC,MAAOA,EAAOS,IAAKpB,QAAQC,KAAKmB,KAAO,SAAUC,EAAKC,GAC1G,GAAID,EAAK,CACR,OAAOE,IAAIC,WAAWH,EAAII,SAE3BC,EAAgBJ,EAAeX,QAKlC,SAASN,EAAkBC,GAC1B,IAAIF,EAAWG,EAAE,cAAgBD,EAAM,MACvCF,EAASI,KAAK,wGAAwGC,GAAG,QAAS,WACjI,IAAIkB,EAAQpB,EAAEK,MACd,IAAID,EAAQgB,EAAMd,KAAK,cAEvBK,OAAOC,KAAK,4BAA8Bb,IAAKA,EAAKK,MAAOA,EAAOS,IAAKpB,QAAQC,KAAKmB,KAAO,SAAUC,EAAKC,GACzG,GAAID,EAAK,CACR,OAAOE,IAAIC,WAAWH,EAAII,SAE3BC,EAAgBJ,EAAeX,GAE/BY,IAAIK,aAAa,cAAgBjB,EAAQ,kBAK5C,SAASe,EAAgBJ,EAAeX,GACvCW,EAAcnB,QAAQ,SAAUG,GAC/B,IAAIF,EAAWG,EAAE,cAAgBD,EAAM,MACvCF,EAASI,KAAK,wCAAwCqB,YAAY,SAAUlB,IAAU,YACtFP,EAASI,KAAK,yCAAyCqB,YAAY,WAAYlB,IAAU,YAEzFP,EAASI,KAAK,2CAA2CqB,YAAY,SAAUlB,IAAU,eACzFP,EAASI,KAAK,4CAA4CqB,YAAY,WAAYlB,IAAU,eAE5FP,EAASI,KAAK,wCAAwCqB,YAAY,SAAUlB,IAAU,YACtFP,EAASI,KAAK,yCAAyCqB,YAAY,WAAYlB,IAAU,cAI3F,OAAOb","file":"public/src/client/account/categories.js","sourcesContent":["'use strict';\n\n\ndefine('forum/account/categories', ['forum/account/header'], function (header) {\n\tvar Categories = {};\n\n\tCategories.init = function () {\n\t\theader.init();\n\n\t\tajaxify.data.categories.forEach(function (category) {\n\t\t\thandleIgnoreWatch(category.cid);\n\t\t});\n\n\t\t$('[component=\"category/watch/all\"]').find('[component=\"category/watching\"], [component=\"category/ignoring\"], [component=\"category/notwatching\"]').on('click', function () {\n\t\t\tvar cids = [];\n\t\t\tvar state = $(this).attr('data-state');\n\t\t\t$('[data-parent-cid=\"0\"]').each(function (index, el) {\n\t\t\t\tcids.push($(el).attr('data-cid'));\n\t\t\t});\n\n\t\t\tsocket.emit('categories.setWatchState', { cid: cids, state: state, uid: ajaxify.data.uid }, function (err, modified_cids) {\n\t\t\t\tif (err) {\n\t\t\t\t\treturn app.alertError(err.message);\n\t\t\t\t}\n\t\t\t\tupdateDropdowns(modified_cids, state);\n\t\t\t});\n\t\t});\n\t};\n\n\tfunction handleIgnoreWatch(cid) {\n\t\tvar category = $('[data-cid=\"' + cid + '\"]');\n\t\tcategory.find('[component=\"category/watching\"], [component=\"category/ignoring\"], [component=\"category/notwatching\"]').on('click', function () {\n\t\t\tvar $this = $(this);\n\t\t\tvar state = $this.attr('data-state');\n\n\t\t\tsocket.emit('categories.setWatchState', { cid: cid, state: state, uid: ajaxify.data.uid }, function (err, modified_cids) {\n\t\t\t\tif (err) {\n\t\t\t\t\treturn app.alertError(err.message);\n\t\t\t\t}\n\t\t\t\tupdateDropdowns(modified_cids, state);\n\n\t\t\t\tapp.alertSuccess('[[category:' + state + '.message]]');\n\t\t\t});\n\t\t});\n\t}\n\n\tfunction updateDropdowns(modified_cids, state) {\n\t\tmodified_cids.forEach(function (cid) {\n\t\t\tvar category = $('[data-cid=\"' + cid + '\"]');\n\t\t\tcategory.find('[component=\"category/watching/menu\"]').toggleClass('hidden', state !== 'watching');\n\t\t\tcategory.find('[component=\"category/watching/check\"]').toggleClass('fa-check', state === 'watching');\n\n\t\t\tcategory.find('[component=\"category/notwatching/menu\"]').toggleClass('hidden', state !== 'notwatching');\n\t\t\tcategory.find('[component=\"category/notwatching/check\"]').toggleClass('fa-check', state === 'notwatching');\n\n\t\t\tcategory.find('[component=\"category/ignoring/menu\"]').toggleClass('hidden', state !== 'ignoring');\n\t\t\tcategory.find('[component=\"category/ignoring/check\"]').toggleClass('fa-check', state === 'ignoring');\n\t\t});\n\t}\n\n\treturn Categories;\n});\n"]}