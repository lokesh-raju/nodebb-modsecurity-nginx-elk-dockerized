"use strict";define("forum/account/edit/password",["forum/account/header","translator","zxcvbn"],function(a,s,e){var r={};r.init=function(){a.init();o()};function o(){var a=$("#inputCurrentPassword");var s=$("#password-notify");var r=$("#password-confirm-notify");var o=$("#inputNewPassword");var t=$("#inputNewPasswordAgain");var l=false;var d=false;function u(){var a=e(o.val());l=false;if(o.val().length<ajaxify.data.minimumPasswordLength){n(s,"[[reset_password:password_too_short]]")}else if(o.val().length>512){n(s,"[[error:password-too-long]]")}else if(!utils.isPasswordValid(o.val())){n(s,"[[user:change_password_error]]")}else if(o.val()===ajaxify.data.username){n(s,"[[user:password_same_as_username]]")}else if(o.val()===ajaxify.data.email){n(s,"[[user:password_same_as_email]]")}else if(a.score<ajaxify.data.minimumPasswordStrength){n(s,"[[user:weak_password]]")}else{i(s);l=true}}function f(){if(o.val()!==t.val()){n(r,"[[user:change_password_error_match]]");d=false}else{if(o.val()){i(r)}else{r.parent().removeClass("alert-success alert-danger");r.children().show();r.find(".msg").html("")}d=true}}o.on("blur",u);t.on("blur",f);$("#changePasswordBtn").on("click",function(){u();f();var e=$(this);if(l&&d){e.addClass("disabled").find("i").removeClass("hide");socket.emit("user.changePassword",{currentPassword:a.val(),newPassword:o.val(),uid:ajaxify.data.theirid},function(n){e.removeClass("disabled").find("i").addClass("hide");a.val("");o.val("");t.val("");s.parent().removeClass("show-success show-danger");r.parent().removeClass("show-success show-danger");d=false;l=false;if(n){return app.alertError(n.message)}if(parseInt(app.user.uid,10)===parseInt(ajaxify.data.uid,10)){window.location.href=config.relative_path+"/login"}else{ajaxify.go("user/"+ajaxify.data.userslug+"/edit")}})}else{if(!d){app.alertError("[[user:change_password_error_match]]")}if(!l){app.alertError("[[user:change_password_error]]")}}return false})}function n(a,e){s.translate(e,function(s){a.html(s);a.parent().removeClass("show-success").addClass("show-danger")})}function i(a){a.html("");a.parent().removeClass("show-danger").addClass("show-success")}return r});
//# sourceMappingURL=password.js.map