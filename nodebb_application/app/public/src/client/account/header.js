"use strict";define("forum/account/header",["coverPhoto","pictureCropper","components","translator","benchpress","accounts/delete"],function(a,e,t,n,o,i){var c={};var r;c.init=function(){r=ajaxify.data.isAdmin||ajaxify.data.isSelf||ajaxify.data.isGlobalModerator;l();s();if(r){f()}t.get("account/follow").on("click",function(){d("follow")});t.get("account/unfollow").on("click",function(){d("unfollow")});t.get("account/chat").on("click",function(){socket.emit("modules.chats.hasPrivateChat",ajaxify.data.uid,function(a,e){if(a){return app.alertError(a.message)}if(e){app.openChat(e)}else{app.newChat(ajaxify.data.uid)}})});t.get("account/new-chat").on("click",function(){app.newChat(ajaxify.data.uid,function(){t.get("account/chat").parent().removeClass("hidden")})});t.get("account/ban").on("click",function(){p(ajaxify.data.theirid)});t.get("account/unban").on("click",g);t.get("account/delete-account").on("click",u.bind(null,"account"));t.get("account/delete-content").on("click",u.bind(null,"content"));t.get("account/delete-all").on("click",u.bind(null,"purge"));t.get("account/flag").on("click",m);t.get("account/block").on("click",h)};function u(a){i[a](ajaxify.data.theirid)}c.banAccount=p;function l(){if(!app.user.uid||app.user.uid!==parseInt(ajaxify.data.theirid,10)){$(".account-sub-links .plugin-link.private").addClass("hide")}}function s(){$(".account-sub-links li").removeClass("active").each(function(){var a=$(this).find("a").attr("href");if(decodeURIComponent(a)===decodeURIComponent(window.location.pathname)){$(this).addClass("active");return false}})}function f(){a.init(t.get("account/cover"),function(a,e,t){socket.emit("user.updateCover",{uid:ajaxify.data.uid,imageData:a,position:e},t)},function(){e.show({title:"[[user:upload_cover_picture]]",socketMethod:"user.updateCover",aspectRatio:NaN,allowSkippingCrop:true,restrictImageDimension:false,paramName:"uid",paramValue:ajaxify.data.theirid,accept:".png,.jpg,.bmp"},function(a){a=(!a.startsWith("http")?config.relative_path:"")+a+"?"+Date.now();t.get("account/cover").css("background-image","url("+a+")")})},b)}function d(a){socket.emit("user."+a,{uid:ajaxify.data.uid},function(e){if(e){return app.alertError(e.message)}t.get("account/follow").toggleClass("hide",a==="follow");t.get("account/unfollow").toggleClass("hide",a==="unfollow");app.alertSuccess("[[global:alert."+a+", "+ajaxify.data.username+"]]")});return false}function p(a,e){a=a||ajaxify.data.theirid;o.parse("admin/partials/temporary-ban",{},function(t){bootbox.dialog({className:"ban-modal",title:"[[user:ban_account]]",message:t,show:true,buttons:{close:{label:"[[global:close]]",className:"btn-link"},submit:{label:"[[user:ban_account]]",callback:function(){var t=$(".ban-modal form").serializeArray().reduce(function(a,e){a[e.name]=e.value;return a},{});var n=t.length>0?Date.now()+t.length*1e3*60*60*(parseInt(t.unit,10)?24:1):0;socket.emit("user.banUsers",{uids:[a],until:n,reason:t.reason||""},function(a){if(a){return app.alertError(a.message)}if(typeof e==="function"){return e()}ajaxify.refresh()})}}}})})}function g(){socket.emit("user.unbanUsers",[ajaxify.data.theirid],function(a){if(a){return app.alertError(a.message)}ajaxify.refresh()})}function m(){require(["flags"],function(a){a.showFlagModal({type:"user",id:ajaxify.data.uid})})}function h(){var a=this;socket.emit("user.toggleBlock",{blockeeUid:ajaxify.data.uid,blockerUid:app.user.uid},function(e,t){if(e){return app.alertError(e.message)}n.translate("[[user:"+(t?"unblock":"block")+"_user]]",function(e){$(a).text(e)})});return false}function b(){n.translate("[[user:remove_cover_picture_confirm]]",function(a){bootbox.confirm(a,function(a){if(!a){return}socket.emit("user.removeCover",{uid:ajaxify.data.uid},function(a){if(!a){ajaxify.refresh()}else{app.alertError(a.message)}})})})}return c});
//# sourceMappingURL=header.js.map