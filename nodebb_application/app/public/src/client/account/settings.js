"use strict";define("forum/account/settings",["forum/account/header","components","sounds","translator"],function(e,t,a,n){var o={};$(window).on("action:ajaxify.start",function(){if(ajaxify.data.template.name==="account/settings"&&$("#bootswatchSkin").val()!==config.bootswatchSkin){app.reskin(config.bootswatchSkin)}});o.init=function(){e.init();$("#submitBtn").on("click",function(){var e=i();if(e.homePageRoute==="custom"&&e.homePageCustom){$.get(config.relative_path+"/"+e.homePageCustom,function(){r(e)}).fail(function(){app.alertError("[[error:invalid-home-page-route]]")})}else{r(e)}return false});$("#bootswatchSkin").on("change",function(){app.reskin($(this).val())});$('[data-property="homePageRoute"]').on("change",s);$(".account").find('button[data-action="play"]').on("click",function(e){e.preventDefault();var t=$(this).parent().parent().find("select").val();a.playSound(t)});s();t.get("user/sessions").find(".timeago").timeago()};function i(){var e={};$(".account").find("input, textarea, select").each(function(t,a){a=$(a);var n=a.attr("data-property");if(a.is("select")){e[n]=a.val();return}switch(a.attr("type")){case"text":case"textarea":e[n]=a.val();break;case"checkbox":e[n]=a.is(":checked")?1:0;break}});return e}function r(e){socket.emit("user.saveSettings",{uid:ajaxify.data.theirid,settings:e},function(e,t){if(e){return app.alertError(e.message)}app.alertSuccess("[[success:settings-saved]]");var o=false;for(var i in t){if(t.hasOwnProperty(i)){if(i==="userLang"&&config.userLang!==t.userLang){o=true}if(config.hasOwnProperty(i)){config[i]=t[i]}}}a.loadMap();if(o&&parseInt(app.user.uid,10)===parseInt(ajaxify.data.theirid,10)){n.translate("[[language:dir]]",config.userLang,function(e){var t=$("html");t.attr("data-dir",e);t.css("direction",e)});$.getScript(config.relative_path+"/assets/vendor/jquery/timeago/locales/jquery.timeago."+utils.userLangToTimeagoCode(config.userLang)+".js",function(){overrides.overrideTimeago();ajaxify.refresh()})}})}function s(){if($('[data-property="homePageRoute"]').val()==="custom"){$("#homePageCustom").show()}else{$("#homePageCustom").hide();$('[data-property="homePageCustom"]').val("")}}return o});
//# sourceMappingURL=settings.js.map