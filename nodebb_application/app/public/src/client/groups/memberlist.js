"use strict";define("forum/groups/memberlist",["autocomplete"],function(e){var r={};var t;var o;var n;r.init=function(e){n=e||"groups/details";o=ajaxify.data.group.name;a();i();u()};function a(){$('[component="groups/members/add"]').on("click",function(){var r=bootbox.dialog({title:"[[groups:details.add-member]]",message:'<input class="form-control" type="text" placeholder="[[global:search]]"/>'});e.user(r.find("input"),function(e,t){var o=t.item.user;if(o){s(o,function(){r.modal("hide")})}})})}function s(e,r){function t(t){if(t){return app.alertError(t)}c([e],function(e){$('[component="groups/members"] tbody').prepend(e)});r()}if(o==="administrators"){socket.emit("admin.user.makeAdmins",[e.uid],t)}else{socket.emit("groups.addMember",{groupName:o,uid:e.uid},t)}}function i(){$('[component="groups/members/search"]').on("keyup",function(){var e=$(this).val();if(t){clearInterval(t);t=0}t=setTimeout(function(){socket.emit("groups.searchMembers",{groupName:o,query:e},function(e,r){if(e){return app.alertError(e.message)}c(r.users,function(e){$('[component="groups/members"] tbody').html(e);$('[component="groups/members"]').attr("data-nextstart",20)})})},250)})}function u(){$('[component="groups/members"] tbody').on("scroll",function(){var e=$(this);var r=(e[0].scrollHeight-e.innerHeight())*.9;if(e.scrollTop()>r&&!$('[component="groups/members/search"]').val()){m()}})}function m(){var e=$('[component="groups/members"]');if(e.attr("loading")){return}e.attr("loading",1);socket.emit("groups.loadMoreMembers",{groupName:o,after:e.attr("data-nextstart")},function(r,t){if(r){return app.alertError(r.message)}if(t&&t.users.length){p(t.users,function(){e.removeAttr("loading");e.attr("data-nextstart",t.nextStart)})}else{e.removeAttr("loading")}})}function p(e,r){e=e.filter(function(e){return!$('[component="groups/members"] [data-uid="'+e.uid+'"]').length});c(e,function(e){$('[component="groups/members"] tbody').append(e);r()})}function c(e,r){app.parseAndTranslate(n,"group.members",{group:{members:e,isOwner:ajaxify.data.group.isOwner}},r)}return r});
//# sourceMappingURL=memberlist.js.map