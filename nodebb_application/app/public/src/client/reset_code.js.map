{"version":3,"sources":["public/src/client/reset_code.js"],"names":["define","zxcvbn","ResetCode","init","reset_code","ajaxify","data","code","resetEl","$","password","repeat","on","strength","val","length","minimumPasswordLength","removeClass","translateText","score","minimumPasswordStrength","prop","html","socket","emit","err","refresh","app","alertError","message","window","location","href","config","relative_path"],"mappings":"AAAA,aAGAA,OAAO,oBAAqB,UAAW,SAAUC,GAChD,IAAIC,KAEJA,EAAUC,KAAO,WAChB,IAAIC,EAAaC,QAAQC,KAAKC,KAE9B,IAAIC,EAAUC,EAAE,UAChB,IAAIC,EAAWD,EAAE,aACjB,IAAIE,EAASF,EAAE,WAEfD,EAAQI,GAAG,QAAS,WACnB,IAAIC,EAAWZ,EAAOS,EAASI,OAC/B,GAAIJ,EAASI,MAAMC,OAASV,QAAQC,KAAKU,sBAAuB,CAC/DP,EAAE,WAAWQ,YAAY,UACzBR,EAAE,kBAAkBS,cAAc,8CAC5B,GAAIR,EAASI,MAAMC,OAAS,IAAK,CACvCN,EAAE,WAAWQ,YAAY,UACzBR,EAAE,kBAAkBS,cAAc,oCAC5B,GAAIR,EAASI,QAAUH,EAAOG,MAAO,CAC3CL,EAAE,WAAWQ,YAAY,UACzBR,EAAE,kBAAkBS,cAAc,kDAC5B,GAAIL,EAASM,MAAQd,QAAQC,KAAKc,wBAAyB,CACjEX,EAAE,WAAWQ,YAAY,UACzBR,EAAE,kBAAkBS,cAAc,8BAC5B,CACNV,EAAQa,KAAK,WAAY,MAAMC,KAAK,2DACpCC,OAAOC,KAAK,qBACXjB,KAAMH,EACNM,SAAUA,EAASI,OACjB,SAAUW,GACZ,GAAIA,EAAK,CACRpB,QAAQqB,UACR,OAAOC,IAAIC,WAAWH,EAAII,SAG3BC,OAAOC,SAASC,KAAOC,OAAOC,cAAgB,WAGhD,OAAO,SAIT,OAAOhC","file":"public/src/client/reset_code.js","sourcesContent":["'use strict';\n\n\ndefine('forum/reset_code', ['zxcvbn'], function (zxcvbn) {\n\tvar\tResetCode = {};\n\n\tResetCode.init = function () {\n\t\tvar reset_code = ajaxify.data.code;\n\n\t\tvar resetEl = $('#reset');\n\t\tvar password = $('#password');\n\t\tvar repeat = $('#repeat');\n\n\t\tresetEl.on('click', function () {\n\t\t\tvar strength = zxcvbn(password.val());\n\t\t\tif (password.val().length < ajaxify.data.minimumPasswordLength) {\n\t\t\t\t$('#notice').removeClass('hidden');\n\t\t\t\t$('#notice strong').translateText('[[reset_password:password_too_short]]');\n\t\t\t} else if (password.val().length > 512) {\n\t\t\t\t$('#notice').removeClass('hidden');\n\t\t\t\t$('#notice strong').translateText('[[error:password-too-long]]');\n\t\t\t} else if (password.val() !== repeat.val()) {\n\t\t\t\t$('#notice').removeClass('hidden');\n\t\t\t\t$('#notice strong').translateText('[[reset_password:passwords_do_not_match]]');\n\t\t\t} else if (strength.score < ajaxify.data.minimumPasswordStrength) {\n\t\t\t\t$('#notice').removeClass('hidden');\n\t\t\t\t$('#notice strong').translateText('[[user:weak_password]]');\n\t\t\t} else {\n\t\t\t\tresetEl.prop('disabled', true).html('<i class=\"fa fa-spin fa-refresh\"></i> Changing Password');\n\t\t\t\tsocket.emit('user.reset.commit', {\n\t\t\t\t\tcode: reset_code,\n\t\t\t\t\tpassword: password.val(),\n\t\t\t\t}, function (err) {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\tajaxify.refresh();\n\t\t\t\t\t\treturn app.alertError(err.message);\n\t\t\t\t\t}\n\n\t\t\t\t\twindow.location.href = config.relative_path + '/login';\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\t};\n\n\treturn ResetCode;\n});\n"]}