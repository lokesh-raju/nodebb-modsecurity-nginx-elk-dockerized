{"version":3,"sources":["public/src/client/topic/move-post.js"],"names":["define","components","postSelect","MovePost","moveModal","moveCommit","init","postEl","app","parseAndTranslate","html","find","$","append","on","closeMoveModal","checkMoveButtonEnable","onPostToggled","showPostsSelected","togglePostSelection","attr","movePosts","pids","length","translateHtml","val","removeAttr","tid","socket","emit","err","alertError","message","forEach","pid","get","fadeOut","this","remove","disable"],"mappings":"AAAA,aAGAA,OAAO,yBAA0B,aAAc,cAAe,SAAUC,EAAYC,GACnF,IAAIC,KAEJ,IAAIC,EACJ,IAAIC,EAEJF,EAASG,KAAO,SAAUC,GACzB,GAAIH,EAAW,CACd,OAEDI,IAAIC,kBAAkB,8BAAgC,SAAUC,GAC/DN,EAAYM,EAEZL,EAAaD,EAAUO,KAAK,uBAE5BC,EAAE,QAAQC,OAAOT,GAEjBA,EAAUO,KAAK,6BAA6BG,GAAG,QAASC,GACxDX,EAAUO,KAAK,YAAYG,GAAG,QAASE,GACvCd,EAAWI,KAAKW,GAChBC,IAEA,GAAIX,EAAQ,CACXL,EAAWiB,oBAAoBZ,EAAQA,EAAOa,KAAK,aAGpDf,EAAWS,GAAG,QAAS,WACtBO,SAKH,SAASH,IACR,GAAIhB,EAAWoB,KAAKC,OAAQ,CAC3BnB,EAAUO,KAAK,SAASa,cAAc,2BAA6BtB,EAAWoB,KAAKC,OAAS,UACtF,CACNnB,EAAUO,KAAK,SAASa,cAAc,2BAIxC,SAASR,IACR,GAAIZ,EAAUO,KAAK,YAAYc,MAAMF,QAAUrB,EAAWoB,KAAKC,OAAQ,CACtElB,EAAWqB,WAAW,gBAChB,CACNrB,EAAWe,KAAK,WAAY,OAI9B,SAASH,IACRD,IACAE,IAGD,SAASG,IACR,IAAIM,EAAMvB,EAAUO,KAAK,YAAYc,MACrCG,OAAOC,KAAK,mBAAqBP,KAAMpB,EAAWoB,KAAMK,IAAKA,GAAO,SAAUG,GAC7E,GAAIA,EAAK,CACR,OAAOtB,IAAIuB,WAAWD,EAAIE,SAE3B9B,EAAWoB,KAAKW,QAAQ,SAAUC,GACjCjC,EAAWkC,IAAI,OAAQ,MAAOD,GAAKE,QAAQ,IAAK,WAC/CxB,EAAEyB,MAAMC,aAIVvB,MAIF,SAASA,IACR,GAAIX,EAAW,CACdA,EAAUkC,SACVlC,EAAY,KACZF,EAAWqC,WAKb,OAAOpC","file":"public/src/client/topic/move-post.js","sourcesContent":["'use strict';\n\n\ndefine('forum/topic/move-post', ['components', 'postSelect'], function (components, postSelect) {\n\tvar MovePost = {};\n\n\tvar moveModal;\n\tvar moveCommit;\n\n\tMovePost.init = function (postEl) {\n\t\tif (moveModal) {\n\t\t\treturn;\n\t\t}\n\t\tapp.parseAndTranslate('partials/move_post_modal', {}, function (html) {\n\t\t\tmoveModal = html;\n\n\t\t\tmoveCommit = moveModal.find('#move_posts_confirm');\n\n\t\t\t$('body').append(moveModal);\n\n\t\t\tmoveModal.find('.close,#move_posts_cancel').on('click', closeMoveModal);\n\t\t\tmoveModal.find('#topicId').on('keyup', checkMoveButtonEnable);\n\t\t\tpostSelect.init(onPostToggled);\n\t\t\tshowPostsSelected();\n\n\t\t\tif (postEl) {\n\t\t\t\tpostSelect.togglePostSelection(postEl, postEl.attr('data-pid'));\n\t\t\t}\n\n\t\t\tmoveCommit.on('click', function () {\n\t\t\t\tmovePosts();\n\t\t\t});\n\t\t});\n\t};\n\n\tfunction showPostsSelected() {\n\t\tif (postSelect.pids.length) {\n\t\t\tmoveModal.find('#pids').translateHtml('[[topic:fork_pid_count, ' + postSelect.pids.length + ']]');\n\t\t} else {\n\t\t\tmoveModal.find('#pids').translateHtml('[[topic:fork_no_pids]]');\n\t\t}\n\t}\n\n\tfunction checkMoveButtonEnable() {\n\t\tif (moveModal.find('#topicId').val().length && postSelect.pids.length) {\n\t\t\tmoveCommit.removeAttr('disabled');\n\t\t} else {\n\t\t\tmoveCommit.attr('disabled', true);\n\t\t}\n\t}\n\n\tfunction onPostToggled() {\n\t\tcheckMoveButtonEnable();\n\t\tshowPostsSelected();\n\t}\n\n\tfunction movePosts() {\n\t\tvar tid = moveModal.find('#topicId').val();\n\t\tsocket.emit('posts.movePosts', { pids: postSelect.pids, tid: tid }, function (err) {\n\t\t\tif (err) {\n\t\t\t\treturn app.alertError(err.message);\n\t\t\t}\n\t\t\tpostSelect.pids.forEach(function (pid) {\n\t\t\t\tcomponents.get('post', 'pid', pid).fadeOut(500, function () {\n\t\t\t\t\t$(this).remove();\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tcloseMoveModal();\n\t\t});\n\t}\n\n\tfunction closeMoveModal() {\n\t\tif (moveModal) {\n\t\t\tmoveModal.remove();\n\t\t\tmoveModal = null;\n\t\t\tpostSelect.disable();\n\t\t}\n\t}\n\n\n\treturn MovePost;\n});\n"]}