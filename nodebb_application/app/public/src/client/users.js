"use strict";define("forum/users",["translator","benchpress"],function(e,n){var t={};var s=0;var a=0;$(window).on("action:ajaxify.start",function(){if(s){clearTimeout(s);s=0}});t.init=function(){app.enterRoom("user_list");var e=utils.params().section?"?section="+utils.params().section:"";$(".nav-pills li").removeClass("active").find('a[href="'+window.location.pathname+e+'"]').parent().addClass("active");t.handleSearch();l();socket.removeListener("event:user_status_change",c);socket.on("event:user_status_change",c)};t.handleSearch=function(e){a=e&&e.resultCount;s=0;$("#search-user").on("keyup",function(){if(s){clearTimeout(s);s=0}s=setTimeout(r,250)});$('.search select, .search input[type="checkbox"]').on("change",function(){r()})};function r(){$('[component="user/search/icon"]').removeClass("fa-search").addClass("fa-spinner fa-spin");var e=$("#search-user").val();var n=f();var t={section:n,page:1};if(!e){return o(t)}t.term=e;t.sortBy=i();if($(".search .online-only").is(":checked")||n==="online"){t.onlineOnly=true}if(n==="banned"){t.bannedOnly=true}if(n==="flagged"){t.flaggedOnly=true}o(t)}function i(){var e;var n=f();if(n==="sort-posts"){e="postcount"}else if(n==="sort-reputation"){e="reputation"}else if(n==="users"){e="joindate"}return e}function o(e){var n=decodeURIComponent($.param(e));$.get(config.relative_path+"/api/users?"+n,u).fail(function(e){if(e&&e.responseJSON&&e.responseJSON.error){app.alertError(e.responseJSON.error)}})}function u(t){n.parse("partials/paginator",{pagination:t.pagination},function(e){$(".pagination-container").replaceWith(e)});if(a){t.users=t.users.slice(0,a)}n.parse("users","users",t,function(n){e.translate(n,function(e){e=$(e);$("#users-container").html(e);e.find("span.timeago").timeago();$('[component="user/search/icon"]').addClass("fa-search").removeClass("fa-spinner fa-spin")})})}function c(e){var n=f();if(n.startsWith("online")||n.startsWith("users")){p(e)}}function p(e){app.updateUserStatus($('#users-container [data-uid="'+e.uid+'"] [component="user/status"]'),e.status)}function f(){return utils.params().section||""}function l(){$('[component="user/invite"]').on("click",function(){bootbox.prompt("[[users:prompt-email]]",function(e){if(!e){return}socket.emit("user.invite",e,function(n){if(n){return app.alertError(n.message)}app.alertSuccess("[[users:invitation-email-sent, "+e+"]]")})})})}return t});
//# sourceMappingURL=users.js.map