{"version":3,"sources":["public/src/modules/alerts.js"],"names":["define","translator","components","Benchpress","module","alert","params","alert_id","Date","getTime","title","trim","message","type","$","length","updateAlert","createNew","parse","alertTpl","translate","translatedHTML","fadeIn","get","prepend","closefn","find","on","fadeOut","timeout","startTimeout","clickfn","addClass","e","target","is","window","trigger","remove","id","html","attr","clearTimeout","parseInt","children","off","removeClass","this","timeoutId","setTimeout","css"],"mappings":"AAAA,aAGAA,OAAO,UAAW,aAAc,aAAc,cAAe,SAAUC,EAAYC,EAAYC,GAC9F,IAAIC,KAEJA,EAAOC,MAAQ,SAAUC,GACxBA,EAAOC,SAAW,iBAAmBD,EAAOC,SAAWD,EAAOC,UAAW,IAAIC,MAAOC,WACpFH,EAAOI,MAAQJ,EAAOI,MAAQJ,EAAOI,MAAMC,QAAU,GAAK,GAC1DL,EAAOM,QAAUN,EAAOM,QAAUN,EAAOM,QAAQD,OAAS,GAC1DL,EAAOO,KAAOP,EAAOO,MAAQ,OAE7B,IAAIR,EAAQS,EAAE,IAAMR,EAAOC,UAC3B,GAAIF,EAAMU,OAAQ,CACjBC,EAAYX,EAAOC,OACb,CACNW,EAAUX,KAIZ,SAASW,EAAUX,GAClBH,EAAWe,MAAM,QAASZ,EAAQ,SAAUa,GAC3ClB,EAAWmB,UAAUD,EAAU,SAAUE,GACxC,IAAIhB,EAAQS,EAAE,IAAMR,EAAOC,UAC3B,GAAIF,EAAMU,OAAQ,CACjB,OAAOC,EAAYX,EAAOC,GAE3BD,EAAQS,EAAEO,GACVhB,EAAMiB,OAAO,KAEbpB,EAAWqB,IAAI,gBAAgBC,QAAQnB,GAEvC,UAAWC,EAAOmB,UAAY,WAAY,CACzCpB,EAAMqB,KAAK,UAAUC,GAAG,QAAS,WAChCrB,EAAOmB,UACPG,EAAQvB,GACR,OAAO,QAIT,GAAIC,EAAOuB,QAAS,CACnBC,EAAazB,EAAOC,EAAOuB,SAG5B,UAAWvB,EAAOyB,UAAY,WAAY,CACzC1B,EACE2B,SAAS,WACTL,GAAG,QAAS,SAAUM,GACtB,IAAKnB,EAAEmB,EAAEC,QAAQC,GAAG,UAAW,CAC9B7B,EAAOyB,UAERH,EAAQvB,KAIXS,EAAEsB,QAAQC,QAAQ,oBAAsBhC,MAAOA,EAAOC,OAAQA,QAKjEF,EAAOkC,OAAS,SAAUC,GACzBzB,EAAE,iBAAmByB,GAAID,UAG1B,SAAStB,EAAYX,EAAOC,GAC3BD,EAAMqB,KAAK,UAAUc,KAAKlC,EAAOI,OACjCL,EAAMqB,KAAK,KAAKc,KAAKlC,EAAOM,SAC5BP,EAAMoC,KAAK,QAAS,iCAAmCnC,EAAOO,KAAO,aAErE6B,aAAaC,SAAStC,EAAMoC,KAAK,aAAc,KAC/C,GAAInC,EAAOuB,QAAS,CACnBC,EAAazB,EAAOC,EAAOuB,SAG5BxB,EAAMuC,WAAWhB,QAAQ,KACzB3B,EAAWmB,UAAUf,EAAMmC,OAAQ,SAAUnB,GAC5ChB,EAAMuC,WAAWtB,OAAO,KACxBjB,EAAMmC,KAAKnB,GACXP,EAAEsB,QAAQC,QAAQ,uBAAyBhC,MAAOA,EAAOC,OAAQA,MAIlED,EAAMwC,IAAI,SAASC,YAAY,WAC/B,UAAWxC,EAAOyB,UAAY,WAAY,CACzC1B,EACE2B,SAAS,WACTL,GAAG,QAAS,SAAUM,GACtB,IAAKnB,EAAEmB,EAAEC,QAAQC,GAAG,UAAW,CAC9B7B,EAAOyB,UAERH,EAAQvB,MAKZ,SAASuB,EAAQvB,GAChBA,EAAMuB,QAAQ,IAAK,WAClBd,EAAEiC,MAAMT,WAIV,SAASR,EAAazB,EAAOwB,GAC5B,IAAImB,EAAYC,WAAW,WAC1BrB,EAAQvB,IACNwB,GAEHxB,EAAMoC,KAAK,YAAaO,GAGxB3C,EAAM6C,IAAI,sBAAuB,QACjC7C,EAAMyC,YAAY,WAElBG,WAAW,WACV5C,EAAM6C,IAAI,sBAAuB,IACjC7C,EAAM6C,IAAI,aAAc,UAAYrB,EAAU,KAAO,gCAAkCA,EAAU,KAAO,cACxGxB,EAAM2B,SAAS,YACb,IAGH3B,EACEsB,GAAG,aAAc,WACjBb,EAAEiC,MAAMG,IAAI,sBAAuB,KAItC,OAAO9C","file":"public/src/modules/alerts.js","sourcesContent":["'use strict';\n\n\ndefine('alerts', ['translator', 'components', 'benchpress'], function (translator, components, Benchpress) {\n\tvar module = {};\n\n\tmodule.alert = function (params) {\n\t\tparams.alert_id = 'alert_button_' + (params.alert_id ? params.alert_id : new Date().getTime());\n\t\tparams.title = params.title ? params.title.trim() || '' : '';\n\t\tparams.message = params.message ? params.message.trim() : '';\n\t\tparams.type = params.type || 'info';\n\n\t\tvar alert = $('#' + params.alert_id);\n\t\tif (alert.length) {\n\t\t\tupdateAlert(alert, params);\n\t\t} else {\n\t\t\tcreateNew(params);\n\t\t}\n\t};\n\n\tfunction createNew(params) {\n\t\tBenchpress.parse('alert', params, function (alertTpl) {\n\t\t\ttranslator.translate(alertTpl, function (translatedHTML) {\n\t\t\t\tvar alert = $('#' + params.alert_id);\n\t\t\t\tif (alert.length) {\n\t\t\t\t\treturn updateAlert(alert, params);\n\t\t\t\t}\n\t\t\t\talert = $(translatedHTML);\n\t\t\t\talert.fadeIn(200);\n\n\t\t\t\tcomponents.get('toaster/tray').prepend(alert);\n\n\t\t\t\tif (typeof params.closefn === 'function') {\n\t\t\t\t\talert.find('button').on('click', function () {\n\t\t\t\t\t\tparams.closefn();\n\t\t\t\t\t\tfadeOut(alert);\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (params.timeout) {\n\t\t\t\t\tstartTimeout(alert, params.timeout);\n\t\t\t\t}\n\n\t\t\t\tif (typeof params.clickfn === 'function') {\n\t\t\t\t\talert\n\t\t\t\t\t\t.addClass('pointer')\n\t\t\t\t\t\t.on('click', function (e) {\n\t\t\t\t\t\t\tif (!$(e.target).is('.close')) {\n\t\t\t\t\t\t\t\tparams.clickfn();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfadeOut(alert);\n\t\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\t$(window).trigger('action:alert.new', { alert: alert, params: params });\n\t\t\t});\n\t\t});\n\t}\n\n\tmodule.remove = function (id) {\n\t\t$('#alert_button_' + id).remove();\n\t};\n\n\tfunction updateAlert(alert, params) {\n\t\talert.find('strong').html(params.title);\n\t\talert.find('p').html(params.message);\n\t\talert.attr('class', 'alert alert-dismissable alert-' + params.type + ' clearfix');\n\n\t\tclearTimeout(parseInt(alert.attr('timeoutId'), 10));\n\t\tif (params.timeout) {\n\t\t\tstartTimeout(alert, params.timeout);\n\t\t}\n\n\t\talert.children().fadeOut(100);\n\t\ttranslator.translate(alert.html(), function (translatedHTML) {\n\t\t\talert.children().fadeIn(100);\n\t\t\talert.html(translatedHTML);\n\t\t\t$(window).trigger('action:alert.update', { alert: alert, params: params });\n\t\t});\n\n\t\t// Handle changes in the clickfn\n\t\talert.off('click').removeClass('pointer');\n\t\tif (typeof params.clickfn === 'function') {\n\t\t\talert\n\t\t\t\t.addClass('pointer')\n\t\t\t\t.on('click', function (e) {\n\t\t\t\t\tif (!$(e.target).is('.close')) {\n\t\t\t\t\t\tparams.clickfn();\n\t\t\t\t\t}\n\t\t\t\t\tfadeOut(alert);\n\t\t\t\t});\n\t\t}\n\t}\n\n\tfunction fadeOut(alert) {\n\t\talert.fadeOut(500, function () {\n\t\t\t$(this).remove();\n\t\t});\n\t}\n\n\tfunction startTimeout(alert, timeout) {\n\t\tvar timeoutId = setTimeout(function () {\n\t\t\tfadeOut(alert);\n\t\t}, timeout);\n\n\t\talert.attr('timeoutId', timeoutId);\n\n\t\t// Reset and start animation\n\t\talert.css('transition-property', 'none');\n\t\talert.removeClass('animate');\n\n\t\tsetTimeout(function () {\n\t\t\talert.css('transition-property', '');\n\t\t\talert.css('transition', 'width ' + (timeout + 450) + 'ms linear, background-color ' + (timeout + 450) + 'ms ease-in');\n\t\t\talert.addClass('animate');\n\t\t}, 50);\n\n\t\t// Handle mouseenter/mouseleave\n\t\talert\n\t\t\t.on('mouseenter', function () {\n\t\t\t\t$(this).css('transition-duration', 0);\n\t\t\t});\n\t}\n\n\treturn module;\n});\n"]}