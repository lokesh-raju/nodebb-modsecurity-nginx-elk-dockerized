{"version":3,"sources":["public/src/modules/categorySearch.js"],"names":["define","categorySearch","init","el","utils","isTouchDevice","searchEl","find","length","toggleVisibility","parent","categoryEls","on","revealParents","cid","parentCid","attr","removeClass","revealChildren","els","each","index","$el","$","updateList","val","toLowerCase","noMatch","cids","liEl","this","isMatch","indexOf","push","toggleClass","css","font-weight","forEach","addClass","ev","preventDefault","stopPropagation","focus","off"],"mappings":"AAAA,aAEAA,OAAO,iBAAkB,WACxB,IAAIC,KAEJA,EAAeC,KAAO,SAAUC,GAC/B,GAAIC,MAAMC,gBAAiB,CAC1B,OAED,IAAIC,EAAWH,EAAGI,KAAK,0CACvB,IAAKD,EAASE,OAAQ,CACrB,OAED,IAAIC,EAAmBH,EAASI,OAAO,mCAAmCF,OAAS,GAClFF,EAASI,OAAO,mCAAmCF,OAAS,EAE7D,IAAIG,EAAcR,EAAGI,KAAK,0CAC1BJ,EAAGS,GAAG,mBAAoB,WACzB,SAASC,EAAcC,GACtB,IAAIC,EAAYZ,EAAGI,KAAK,0CAA4CO,EAAM,MAAME,KAAK,mBACrF,GAAID,EAAW,CACdZ,EAAGI,KAAK,0CAA4CQ,EAAY,MAAME,YAAY,UAClFJ,EAAcE,IAIhB,SAASG,EAAeJ,GACvB,IAAIK,EAAMhB,EAAGI,KAAK,iDAAmDO,EAAM,MAC3EK,EAAIC,KAAK,SAAUC,EAAOlB,GACzB,IAAImB,EAAMC,EAAEpB,GACZmB,EAAIL,YAAY,UAChBC,EAAeI,EAAIN,KAAK,eAI1B,SAASQ,IACR,IAAIC,EAAMnB,EAASC,KAAK,SAASkB,MAAMC,cACvC,IAAIC,EAAU,KACd,IAAIC,KACJjB,EAAYS,KAAK,WAChB,IAAIS,EAAON,EAAEO,MACb,IAAIC,EAAUF,EAAKb,KAAK,aAAaU,cAAcM,QAAQP,MAAU,EACrE,GAAIE,GAAWI,EAAS,CACvBJ,EAAU,MAEX,GAAII,GAAWN,EAAK,CACnBG,EAAKK,KAAKJ,EAAKb,KAAK,aAErBa,EAAKK,YAAY,UAAWH,GAASxB,KAAK,iCAAiC4B,KAAMC,cAAeX,GAAOM,EAAU,OAAS,aAG3HH,EAAKS,QAAQ,SAAUvB,GACtBD,EAAcC,GACdI,EAAeJ,KAGhBX,EAAGI,KAAK,iEAAiE2B,YAAY,UAAWP,GAEjG,GAAIlB,EAAkB,CACrBN,EAAGI,KAAK,oBAAoB+B,SAAS,UACrChC,EAASW,YAAY,UAGtBX,EAASM,GAAG,QAAS,SAAU2B,GAC9BA,EAAGC,iBACHD,EAAGE,oBAEJnC,EAASC,KAAK,SAASkB,IAAI,IAAIb,GAAG,QAASY,GAC3CA,MAEDrB,EAAGS,GAAG,oBAAqB,WAC1BN,EAASC,KAAK,SAASmC,UAGxBvC,EAAGS,GAAG,mBAAoB,WACzB,GAAIH,EAAkB,CACrBN,EAAGI,KAAK,oBAAoBU,YAAY,UACxCX,EAASgC,SAAS,UAGnBhC,EAASqC,IAAI,SACbrC,EAASC,KAAK,SAASoC,IAAI,YAI7B,OAAO1C","file":"public/src/modules/categorySearch.js","sourcesContent":["'use strict';\n\ndefine('categorySearch', function () {\n\tvar categorySearch = {};\n\n\tcategorySearch.init = function (el) {\n\t\tif (utils.isTouchDevice()) {\n\t\t\treturn;\n\t\t}\n\t\tvar searchEl = el.find('[component=\"category-selector-search\"]');\n\t\tif (!searchEl.length) {\n\t\t\treturn;\n\t\t}\n\t\tvar toggleVisibility = searchEl.parent('[component=\"category/dropdown\"]').length > 0 ||\n\t\t\tsearchEl.parent('[component=\"category-selector\"]').length > 0;\n\n\t\tvar categoryEls = el.find('[component=\"category/list\"] [data-cid]');\n\t\tel.on('show.bs.dropdown', function () {\n\t\t\tfunction revealParents(cid) {\n\t\t\t\tvar parentCid = el.find('[component=\"category/list\"] [data-cid=\"' + cid + '\"]').attr('data-parent-cid');\n\t\t\t\tif (parentCid) {\n\t\t\t\t\tel.find('[component=\"category/list\"] [data-cid=\"' + parentCid + '\"]').removeClass('hidden');\n\t\t\t\t\trevealParents(parentCid);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction revealChildren(cid) {\n\t\t\t\tvar els = el.find('[component=\"category/list\"] [data-parent-cid=\"' + cid + '\"]');\n\t\t\t\tels.each(function (index, el) {\n\t\t\t\t\tvar $el = $(el);\n\t\t\t\t\t$el.removeClass('hidden');\n\t\t\t\t\trevealChildren($el.attr('data-cid'));\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction updateList() {\n\t\t\t\tvar val = searchEl.find('input').val().toLowerCase();\n\t\t\t\tvar noMatch = true;\n\t\t\t\tvar cids = [];\n\t\t\t\tcategoryEls.each(function () {\n\t\t\t\t\tvar liEl = $(this);\n\t\t\t\t\tvar isMatch = liEl.attr('data-name').toLowerCase().indexOf(val) !== -1;\n\t\t\t\t\tif (noMatch && isMatch) {\n\t\t\t\t\t\tnoMatch = false;\n\t\t\t\t\t}\n\t\t\t\t\tif (isMatch && val) {\n\t\t\t\t\t\tcids.push(liEl.attr('data-cid'));\n\t\t\t\t\t}\n\t\t\t\t\tliEl.toggleClass('hidden', !isMatch).find('[component=\"category-markup\"]').css({ 'font-weight': val && isMatch ? 'bold' : 'normal' });\n\t\t\t\t});\n\n\t\t\t\tcids.forEach(function (cid) {\n\t\t\t\t\trevealParents(cid);\n\t\t\t\t\trevealChildren(cid);\n\t\t\t\t});\n\n\t\t\t\tel.find('[component=\"category/list\"] [component=\"category/no-matches\"]').toggleClass('hidden', !noMatch);\n\t\t\t}\n\t\t\tif (toggleVisibility) {\n\t\t\t\tel.find('.dropdown-toggle').addClass('hidden');\n\t\t\t\tsearchEl.removeClass('hidden');\n\t\t\t}\n\n\t\t\tsearchEl.on('click', function (ev) {\n\t\t\t\tev.preventDefault();\n\t\t\t\tev.stopPropagation();\n\t\t\t});\n\t\t\tsearchEl.find('input').val('').on('keyup', updateList);\n\t\t\tupdateList();\n\t\t});\n\t\tel.on('shown.bs.dropdown', function () {\n\t\t\tsearchEl.find('input').focus();\n\t\t});\n\n\t\tel.on('hide.bs.dropdown', function () {\n\t\t\tif (toggleVisibility) {\n\t\t\t\tel.find('.dropdown-toggle').removeClass('hidden');\n\t\t\t\tsearchEl.addClass('hidden');\n\t\t\t}\n\n\t\t\tsearchEl.off('click');\n\t\t\tsearchEl.find('input').off('keyup');\n\t\t});\n\t};\n\n\treturn categorySearch;\n});\n"]}