{"version":3,"sources":["public/src/modules/categorySelector.js"],"names":["define","Benchpress","translator","categorySearch","categorySelector","init","el","callback","selector","selectedCategory","on","categoryEl","$","this","hasClass","selectCategory","attr","cid","find","name","length","html","translateHtml","getSelectedCategory","getSelectedCid","modal","categories","ajaxify","data","allCategories","parse","translate","bootbox","dialog","title","message","buttons","save","label","className","submit","ev","preventDefault"],"mappings":"AAAA,aAEAA,OAAO,oBAAqB,aAAc,aAAc,kBAAmB,SAAUC,EAAYC,EAAYC,GAC5G,IAAIC,KAEJA,EAAiBC,KAAO,SAAUC,EAAIC,GACrCA,EAAWA,GAAY,aACvB,IAAIC,GACHF,GAAIA,EACJG,iBAAkB,MAGnBH,EAAGI,GAAG,QAAS,aAAc,WAC5B,IAAIC,EAAaC,EAAEC,MACnB,GAAIF,EAAWG,SAAS,YAAa,CACpC,OAAO,MAERN,EAASO,eAAeJ,EAAWK,KAAK,aACxCT,EAASC,EAASC,oBAGnBN,EAAeE,KAAKC,GAEpBE,EAASO,eAAiB,SAAUE,GACnC,IAAIN,EAAaH,EAASF,GAAGY,KAAK,cAAgBD,EAAM,MACxDT,EAASC,kBACRQ,IAAKA,EACLE,KAAMR,EAAWK,KAAK,cAGvB,GAAIL,EAAWS,OAAQ,CACtBZ,EAASF,GAAGY,KAAK,4CAA4CG,KAAKV,EAAWO,KAAK,iCAAiCG,YAC7G,CACNb,EAASF,GAAGY,KAAK,4CAA4CI,cAAc,4CAG7Ed,EAASe,oBAAsB,WAC9B,OAAOf,EAASC,kBAEjBD,EAASgB,eAAiB,WACzB,OAAOhB,EAASC,iBAAmBD,EAASC,iBAAiBQ,IAAM,GAEpE,OAAOT,GAGRJ,EAAiBqB,MAAQ,SAAUC,EAAYnB,GAC9C,UAAWmB,IAAe,WAAY,CACrCnB,EAAWmB,EACXA,EAAaC,QAAQC,KAAKC,cAE3B5B,EAAW6B,MAAM,6CAChBJ,WAAYA,GACV,SAAUL,GACZnB,EAAW6B,UAAUV,EAAM,SAAUA,GACpC,IAAII,EAAQO,QAAQC,QACnBC,MAAO,uCACPC,QAASd,EACTe,SACCC,MACCC,MAAO,oBACPC,UAAW,cACXhC,SAAUiC,MAIb,IAAIhC,EAAWJ,EAAiBC,KAAKoB,EAAMP,KAAK,oCAChD,SAASsB,EAAOC,GACfA,EAAGC,iBACH,GAAIlC,EAASC,iBAAkB,CAC9BF,EAASC,EAASC,iBAAiBQ,KACnCQ,EAAMA,MAAM,QAEb,OAAO,MAGRA,EAAMP,KAAK,QAAQR,GAAG,SAAU8B,QAKnC,OAAOpC","file":"public/src/modules/categorySelector.js","sourcesContent":["'use strict';\n\ndefine('categorySelector', ['benchpress', 'translator', 'categorySearch'], function (Benchpress, translator, categorySearch) {\n\tvar categorySelector = {};\n\n\tcategorySelector.init = function (el, callback) {\n\t\tcallback = callback || function () {};\n\t\tvar selector = {\n\t\t\tel: el,\n\t\t\tselectedCategory: null,\n\t\t};\n\n\t\tel.on('click', '[data-cid]', function () {\n\t\t\tvar categoryEl = $(this);\n\t\t\tif (categoryEl.hasClass('disabled')) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tselector.selectCategory(categoryEl.attr('data-cid'));\n\t\t\tcallback(selector.selectedCategory);\n\t\t});\n\n\t\tcategorySearch.init(el);\n\n\t\tselector.selectCategory = function (cid) {\n\t\t\tvar categoryEl = selector.el.find('[data-cid=\"' + cid + '\"]');\n\t\t\tselector.selectedCategory = {\n\t\t\t\tcid: cid,\n\t\t\t\tname: categoryEl.attr('data-name'),\n\t\t\t};\n\n\t\t\tif (categoryEl.length) {\n\t\t\t\tselector.el.find('[component=\"category-selector-selected\"]').html(categoryEl.find('[component=\"category-markup\"]').html());\n\t\t\t} else {\n\t\t\t\tselector.el.find('[component=\"category-selector-selected\"]').translateHtml('[[topic:thread_tools.select_category]]');\n\t\t\t}\n\t\t};\n\t\tselector.getSelectedCategory = function () {\n\t\t\treturn selector.selectedCategory;\n\t\t};\n\t\tselector.getSelectedCid = function () {\n\t\t\treturn selector.selectedCategory ? selector.selectedCategory.cid : 0;\n\t\t};\n\t\treturn selector;\n\t};\n\n\tcategorySelector.modal = function (categories, callback) {\n\t\tif (typeof categories === 'function') {\n\t\t\tcallback = categories;\n\t\t\tcategories = ajaxify.data.allCategories;\n\t\t}\n\t\tBenchpress.parse('admin/partials/categories/select-category', {\n\t\t\tcategories: categories,\n\t\t}, function (html) {\n\t\t\ttranslator.translate(html, function (html) {\n\t\t\t\tvar modal = bootbox.dialog({\n\t\t\t\t\ttitle: '[[modules:composer.select_category]]',\n\t\t\t\t\tmessage: html,\n\t\t\t\t\tbuttons: {\n\t\t\t\t\t\tsave: {\n\t\t\t\t\t\t\tlabel: '[[global:select]]',\n\t\t\t\t\t\t\tclassName: 'btn-primary',\n\t\t\t\t\t\t\tcallback: submit,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t\tvar selector = categorySelector.init(modal.find('[component=\"category-selector\"]'));\n\t\t\t\tfunction submit(ev) {\n\t\t\t\t\tev.preventDefault();\n\t\t\t\t\tif (selector.selectedCategory) {\n\t\t\t\t\t\tcallback(selector.selectedCategory.cid);\n\t\t\t\t\t\tmodal.modal('hide');\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tmodal.find('form').on('submit', submit);\n\t\t\t});\n\t\t});\n\t};\n\n\treturn categorySelector;\n});\n"]}