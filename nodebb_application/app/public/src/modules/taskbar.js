"use strict";define("taskbar",["benchpress","translator"],function(t,a){var i={};i.init=function(){var a=this;t.parse("modules/taskbar",{},function(t){a.taskbar=$(t);a.tasklist=a.taskbar.find("ul");$(document.body).append(a.taskbar);a.taskbar.on("click","li",function(){var t=$(this);var a=t.attr("data-module");var e=t.attr("data-uuid");require([a],function(a){if(!t.hasClass("active")){n();a.load(e);i.toggleNew(e,false);app.alternatingTitle("");i.tasklist.removeClass("active");t.addClass("active")}else{a.minimize(e)}});return false})});$(window).on("action:app.loggedOut",function(){i.closeAll()})};i.close=function(t,a){var e=i.tasklist.find('[data-module="'+t+'"][data-uuid="'+a+'"]');var n="close";if(t==="chat"){n="closeByUUID"}if(e.length){require([t],function(t){if(typeof t[n]==="function"){t[n](a)}})}};i.closeAll=function(t){var a="[data-uuid]";if(t){a='[data-module="'+t+'"]'+a}i.tasklist.find(a).each(function(a,e){i.close(t||e.getAttribute("data-module"),e.getAttribute("data-uuid"))})};i.discard=function(t,a){var n=i.tasklist.find('[data-module="'+t+'"][data-uuid="'+a+'"]');n.remove();e()};i.push=function(t,a,e,n){n=n||function(){};var o=i.tasklist.find('li[data-uuid="'+a+'"]');var d={module:t,uuid:a,options:e,element:o};$(window).trigger("filter:taskbar.push",d);if(!o.length&&d.module){s(d,n)}else{n(o)}};i.get=function(t){var a=$('[data-module="'+t+'"]').map(function(t,a){return $(a).data()});return a};i.minimize=function(t,a){var e=i.tasklist.find('[data-module="'+t+'"][data-uuid="'+a+'"]');e.toggleClass("active",false)};i.toggleNew=function(t,a,e){var n=i.tasklist.find('[data-uuid="'+t+'"]');n.toggleClass("new",a);if(!e){$(window).trigger("action:taskbar.toggleNew",t)}};i.updateActive=function(t){var a=i.tasklist.find("li");a.removeClass("active");a.filter('[data-uuid="'+t+'"]').addClass("active");$("[data-uuid]:not([data-module])").toggleClass("modal-unfocused",true);$('[data-uuid="'+t+'"]:not([data-module])').toggleClass("modal-unfocused",false)};i.isActive=function(t){var a=i.tasklist.find('li[data-uuid="'+t+'"]');return a.hasClass("active")};function e(){var t=i.tasklist.find("li");if(t.length>0){i.taskbar.attr("data-active","1")}else{i.taskbar.removeAttr("data-active")}}function n(){i.tasklist.find(".active").removeClass("active")}function s(t,s){a.translate(t.options.title,function(a){var o=$("<div></div>").text(a||"NodeBB Task").html();var d=$("<li></li>").addClass(t.options.className).html('<a href="#"'+(t.options.image?" style=\"background-image: url('"+t.options.image+"'); background-size: cover;\"":"")+">"+(t.options.icon?'<i class="fa '+t.options.icon+'"></i> ':"")+'<span component="taskbar/title">'+o+"</span>"+"</a>").attr({title:o,"data-module":t.module,"data-uuid":t.uuid}).addClass(t.options.state!==undefined?t.options.state:"active");if(!t.options.state||t.options.state==="active"){n()}i.tasklist.append(d);e();t.element=d;d.data(t);$(window).trigger("action:taskbar.pushed",t);s(d)})}var o=function(t,a,i){switch(a){case"title":t.find('[component="taskbar/title"]').text(i);break;case"icon":t.find("i").attr("class","fa fa-"+i);break;case"image":t.find("a").css("background-image",'url("'+i+'")');break;case"background-color":t.find("a").css("background-color",i);break}};i.update=function(t,a,e){var n=i.tasklist.find('[data-module="'+t+'"][data-uuid="'+a+'"]');if(!n.length){return}var s=n.data();Object.keys(e).forEach(function(t){s[t]=e[t];o(n,t,e[t])});n.data(s)};i.updateTitle=function(t,a,e){console.warn("[taskbar] .updateTitle() is deprecated, use .update() instead");i.tasklist.find('[data-module="'+t+'"][data-uuid="'+a+'"] [component="taskbar/title"]').text(e)};return i});
//# sourceMappingURL=taskbar.js.map