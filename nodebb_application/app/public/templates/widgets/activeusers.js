!function(t){"object"==typeof module&&module.exports?module.exports=t():"function"==typeof define&&define.amd&&define(t)}(function(){function i(t,e,r,n,s){t.__escape;return'<div class="active-users">\r\n\t'+i.blocks.active_users(t,e,r,n,s)+"\r\n</div>\r\n\r\n<script type=\"text/javascript\">\r\n\t(function() {\r\n\t\tfunction handleActiveUsers() {\r\n\t\t\tfunction onNewTopic(topic) {\r\n\t\t\t\tvar activeUser = $('.active-users').find('a[data-uid=\"' + topic.uid + '\"]');\r\n\r\n\t\t\t\tif (activeUser.length) {\r\n\t\t\t\t\treturn activeUser.prependTo($('.active-users'));\r\n\t\t\t\t}\r\n\r\n\t\t\t\tapp.parseAndTranslate('widgets/activeusers', 'active_users', {\r\n\t\t\t\t\trelative_path: config.relative_path,\r\n\t\t\t\t\tactive_users: [{\r\n\t\t\t\t\t\tuid: topic.uid,\r\n\t\t\t\t\t\tusername: topic.user.username,\r\n\t\t\t\t\t\tuserslug: topic.user.userslug,\r\n\t\t\t\t\t\tpicture: topic.user.picture,\r\n\t\t\t\t\t\t'icon:bgColor': topic.user['icon:bgColor'],\r\n\t\t\t\t\t\t'icon:text': topic.user['icon:text']\r\n\t\t\t\t\t}]\r\n\t\t\t\t}, function (html) {\r\n\t\t\t\t\thtml.prependTo($('.active-users'))\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tfunction onAjaxifyEnd() {\r\n\t\t\t\tsocket.removeListener('event:new_topic', onNewTopic);\r\n\t\t\t\tif ($('.active-users').length) {\r\n\t\t\t\t\tsocket.on('event:new_topic', onNewTopic);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$(window).off('action:ajaxify.end', onAjaxifyEnd);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t$(window).on('action:ajaxify.end', onAjaxifyEnd);\r\n\t\t}\r\n\r\n\t\tif (window.jQuery) {\r\n\t\t\thandleActiveUsers();\r\n\t\t} else {\r\n\t\t\twindow.addEventListener('load', handleActiveUsers);\r\n\t\t}\r\n\t})();\r\n<\/script>"}return i.blocks={active_users:function(t,e,r,n){var s=t.__escape;return n(r(e&&e.active_users),function(t){return'\r\n\t<a data-uid="'+s(r(e&&e.active_users&&e.active_users[t]&&e.active_users[t].uid))+'" href="'+s(r(e&&e.relative_path))+"/user/"+s(r(e&&e.active_users&&e.active_users[t]&&e.active_users[t].userslug))+'">\r\n\t\t'+(r(e&&e.active_users&&e.active_users[t]&&e.active_users[t].picture)?'\r\n\t\t<img title="'+s(r(e&&e.active_users&&e.active_users[t]&&e.active_users[t].username))+'" src="'+s(r(e&&e.active_users&&e.active_users[t]&&e.active_users[t].picture))+'" class="avatar avatar-sm avatar-rounded not-responsive" />\r\n\t\t':'\r\n\t\t<div title="'+s(r(e&&e.active_users&&e.active_users[t]&&e.active_users[t].username))+'" class="avatar avatar-sm avatar-rounded not-responsive" style="background-color: '+s(r(e&&e.active_users&&e.active_users[t]&&e.active_users[t]["icon:bgColor"]))+';">'+s(r(e&&e.active_users&&e.active_users[t]&&e.active_users[t]["icon:text"]))+"</div>\r\n\t\t")+"\r\n\t</a>\r\n\t"},function(){return""})}},i});